@{
    ViewBag.Title = "Request Card";
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}

<div class="card" style="max-width: 800px; margin: 0 auto;">
    <div class="card-header">
        <div class="card-title">ğŸ’³ Request New Card</div>
    </div>
    
    <div style="padding: 32px;">
        <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 24px; border-radius: 16px; margin-bottom: 32px; border-left: 4px solid #06b6d4;">
            <h3 style="margin: 0 0 12px 0; color: #0891b2;">ğŸ“‹ Card Types Available</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 16px;">
                <div style="background: white; padding: 16px; border-radius: 12px;">
                    <h4 style="color: #06b6d4; margin: 0 0 8px 0;">ğŸ’³ Debit Card</h4>
                    <p style="color: #64748b; font-size: 14px; margin: 0;">Direct access to your account balance. No fees.</p>
                </div>
                <div style="background: white; padding: 16px; border-radius: 12px;">
                    <h4 style="color: #8b5cf6; margin: 0 0 8px 0;">ğŸ’ Credit Card</h4>
                    <p style="color: #64748b; font-size: 14px; margin: 0;">$5,000 credit limit. Build your credit score.</p>
                </div>
            </div>
        </div>

        @if (ViewBag.PendingRequests != null && ((List<BankAndFinance.Models.CardRequest>)ViewBag.PendingRequests).Any())
        {
            <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                <h4 style="margin: 0 0 12px 0; color: #92400e;">â³ You have @((ViewBag.PendingRequests as List<BankAndFinance.Models.CardRequest>).Count) pending request(s)</h4>
                <p style="color: #78350f; margin: 0; font-size: 14px;">Your card requests are being reviewed by an administrator. You'll be notified once approved.</p>
                <a href="@Url.Action("MyRequests")" class="btn btn-outline" style="margin-top: 12px; background: white;">View My Requests</a>
            </div>
        }

        <form method="post" asp-action="RequestCard" id="cardRequestForm" onsubmit="return confirmRequest()">
            <div class="form-group">
                <label for="cardType">Select Card Type</label>
                <select class="form-select" id="cardType" name="cardType" required style="padding: 16px; font-size: 16px;">
                    <option value="">-- Choose a card type --</option>
                    <option value="Debit">ğŸ’³ Debit Card - Instant access to your balance</option>
                    <option value="Credit">ğŸ’ Credit Card - Build your credit</option>
                </select>
            </div>

            <div class="form-group">
                <label for="requestedLimit">Requested Card Limit (Optional for Credit Cards)</label>
                <input type="number" class="form-input" id="requestedLimit" name="requestedLimit" step="0.01" min="0" placeholder="e.g., 5000.00" style="padding: 16px;">
                <p style="color: #64748b; font-size: 13px; margin-top: 8px;">Leave blank for default limit. Subject to admin approval.</p>
            </div>

            <div class="form-group">
                <label for="reason">Reason for Request (Optional)</label>
                <textarea class="form-input" id="reason" name="reason" rows="3" placeholder="e.g., Online shopping, Travel expenses, Emergency fund" style="padding: 16px;"></textarea>
            </div>

            <div class="form-group" style="background: #f8fafc; padding: 20px; border-radius: 12px;">
                <h4 style="margin: 0 0 12px 0;">ğŸ“„ Card Features:</h4>
                <ul style="color: #64748b; margin: 0; padding-left: 20px;">
                    <li>âœ… Contactless payments</li>
                    <li>âœ… Online shopping worldwide</li>
                    <li>âœ… ATM withdrawals</li>
                    <li>âœ… Secure chip technology</li>
                    <li>âœ… 3-year validity</li>
                    <li>âœ… Free replacement if lost</li>
                </ul>
            </div>

            <div style="background: #fef3c7; padding: 16px; border-radius: 8px; margin-top: 20px;">
                <p style="margin: 0; color: #92400e; font-size: 14px;">
                    â„¹ï¸ <strong>Please note:</strong> Card requests require admin approval. You'll receive a notification once your request is processed.
                </p>
            </div>

            <div style="margin-top: 32px; display: flex; gap: 12px;">
                <button type="submit" class="btn btn-primary" style="flex: 1; padding: 16px; font-size: 16px;">
                    âœ… Submit Request
                </button>
                <a href="@Url.Action("MyCards")" class="btn btn-outline" style="flex: 1; padding: 16px; font-size: 16px; text-align: center;">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<script>
function confirmRequest() {
    const cardType = document.getElementById('cardType').value;
    if (!cardType) {
        alert('Please select a card type');
        return false;
    }
    
    return confirm(`Are you sure you want to request a ${cardType} card? The card will be delivered to your registered address within 7-10 business days.`);
}
</script>
